<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>CheerfulGoat ç™»å½•</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-orange-50 h-screen flex items-center justify-center">
    <div class="bg-white p-10 rounded-2xl shadow-xl w-96 border border-orange-100 text-center">
        <h2 class="text-3xl font-bold text-orange-600 mb-2">CheerfulGoat</h2>
        <p class="text-gray-500 mb-8">ä¸­å°ä»»åŠ¡ç®¡ç†ç³»ç»Ÿ</p>
        
        <div class="space-y-5 text-left">
            <div>
                <label class="block text-sm font-medium text-gray-600">ç®¡ç†è´¦å·</label>
                <input type="text" id="u" class="w-full border-2 border-orange-100 p-3 rounded-xl mt-1 outline-none focus:border-orange-500" placeholder="admin">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-600">ç™»å½•å¯†ç </label>
                <input type="password" id="p" class="w-full border-2 border-orange-100 p-3 rounded-xl mt-1 outline-none focus:border-orange-500" placeholder="123456">
            </div>
            <button onclick="doLogin()" class="w-full bg-orange-500 text-white py-3 rounded-xl font-bold hover:bg-orange-600 shadow-lg transition">
                å¼€å¯ä»»åŠ¡çœ‹æ¿
            </button>
        </div>
        <p id="msg" class="text-red-500 text-sm mt-4 hidden"></p>
    </div>

    <script>
        // ğŸš¨ è¯·ä¸€å®šè¦æŠŠè¿™é‡Œæ¢æˆæ‚¨åœ¨ Render ä¸Šçš„çœŸå®ç½‘å€
        const API = "https://cheerfulgoat-task-system.onrender.com";

        async function doLogin() {
            const user = document.getElementById('u').value;
            const pass = document.getElementById('p').value;
            const msg = document.getElementById('msg');

            try {
                // æ³¨æ„ï¼šè¿™é‡Œè¦åŒ¹é…æ‚¨ FastAPI åç«¯çš„ç™»å½•æ¥å£
                const res = await fetch(`${API}/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username: user, password: pass })
                });

                const data = await res.json();

                if (res.ok) {
                    // ğŸ”‘ æ‹¿åˆ°é€šè¡Œè¯å¹¶å­˜èµ·æ¥
                    localStorage.setItem('cfg_token', data.access_token);
                    alert("ç™»å½•æˆåŠŸï¼è¿™å°±å¸¦æ‚¨å»çœ‹ä»»åŠ¡ã€‚");
                    window.location.href = "index.html"; 
                } else {
                    msg.innerText = "è´¦å·æˆ–å¯†ç ä¸å¯¹ï¼Œè¯·è€äººå®¶å†è¯•ä¸€æ¬¡ã€‚";
                    msg.classList.remove('hidden');
                }
            } catch (err) {
                alert("è¿ä¸ä¸Šåç«¯ï¼Œè¯·æ£€æŸ¥ Render åœ°å€æ˜¯å¦æ­£ç¡®ã€‚");
            }
        }
    </script>
</body>
</html>
